class Scene
  TITLE_X_START = 6
  TITLE_Y_START = 12

  TITLE_N_START = 0
  TITLE_I_START = 5
  TITLE_B1_START = 7
  TITLE_B2_START = 11
  TITLE_L_START = 15
  TITLE_E_START = 19
  TITLE_S_START = 23

  TITLE = [
    # N
    [TITLE_X_START + TITLE_N_START + 0, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_N_START + 0, TITLE_Y_START + 1],
    [TITLE_X_START + TITLE_N_START + 0, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_N_START + 0, TITLE_Y_START + 3],
    [TITLE_X_START + TITLE_N_START + 0, TITLE_Y_START + 4],
    [TITLE_X_START + TITLE_N_START + 1, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_N_START + 2, TITLE_Y_START + 1],
    [TITLE_X_START + TITLE_N_START + 3, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_N_START + 3, TITLE_Y_START + 1],
    [TITLE_X_START + TITLE_N_START + 3, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_N_START + 3, TITLE_Y_START + 3],
    [TITLE_X_START + TITLE_N_START + 3, TITLE_Y_START + 4],
    # I
    [TITLE_X_START + TITLE_I_START + 0, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_I_START + 0, TITLE_Y_START + 1],
    [TITLE_X_START + TITLE_I_START + 0, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_I_START + 0, TITLE_Y_START + 3],
    [TITLE_X_START + TITLE_I_START + 0, TITLE_Y_START + 4],
    # B
    [TITLE_X_START + TITLE_B1_START + 0, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_B1_START + 0, TITLE_Y_START + 1],
    [TITLE_X_START + TITLE_B1_START + 0, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_B1_START + 0, TITLE_Y_START + 3],
    [TITLE_X_START + TITLE_B1_START + 0, TITLE_Y_START + 4],
    [TITLE_X_START + TITLE_B1_START + 1, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_B1_START + 1, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_B1_START + 1, TITLE_Y_START + 4],
    [TITLE_X_START + TITLE_B1_START + 2, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_B1_START + 2, TITLE_Y_START + 1],
    [TITLE_X_START + TITLE_B1_START + 2, TITLE_Y_START + 3],
    [TITLE_X_START + TITLE_B1_START + 2, TITLE_Y_START + 4],
    # B
    [TITLE_X_START + TITLE_B2_START + 0, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_B2_START + 0, TITLE_Y_START + 1],
    [TITLE_X_START + TITLE_B2_START + 0, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_B2_START + 0, TITLE_Y_START + 3],
    [TITLE_X_START + TITLE_B2_START + 0, TITLE_Y_START + 4],
    [TITLE_X_START + TITLE_B2_START + 1, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_B2_START + 1, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_B2_START + 1, TITLE_Y_START + 4],
    [TITLE_X_START + TITLE_B2_START + 2, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_B2_START + 2, TITLE_Y_START + 1],
    [TITLE_X_START + TITLE_B2_START + 2, TITLE_Y_START + 3],
    [TITLE_X_START + TITLE_B2_START + 2, TITLE_Y_START + 4],
    # L
    [TITLE_X_START + TITLE_L_START + 0, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_L_START + 0, TITLE_Y_START + 1],
    [TITLE_X_START + TITLE_L_START + 0, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_L_START + 0, TITLE_Y_START + 3],
    [TITLE_X_START + TITLE_L_START + 0, TITLE_Y_START + 4],
    [TITLE_X_START + TITLE_L_START + 1, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_L_START + 2, TITLE_Y_START + 0],
    # E
    [TITLE_X_START + TITLE_E_START + 0, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_E_START + 0, TITLE_Y_START + 1],
    [TITLE_X_START + TITLE_E_START + 0, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_E_START + 0, TITLE_Y_START + 3],
    [TITLE_X_START + TITLE_E_START + 0, TITLE_Y_START + 4],
    [TITLE_X_START + TITLE_E_START + 1, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_E_START + 1, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_E_START + 1, TITLE_Y_START + 4],
    [TITLE_X_START + TITLE_E_START + 2, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_E_START + 2, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_E_START + 2, TITLE_Y_START + 4],
    # S
    [TITLE_X_START + TITLE_S_START + 0, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_S_START + 0, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_S_START + 0, TITLE_Y_START + 3],
    [TITLE_X_START + TITLE_S_START + 0, TITLE_Y_START + 4],
    [TITLE_X_START + TITLE_S_START + 1, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_S_START + 1, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_S_START + 1, TITLE_Y_START + 4],
    [TITLE_X_START + TITLE_S_START + 2, TITLE_Y_START + 0],
    [TITLE_X_START + TITLE_S_START + 2, TITLE_Y_START + 1],
    [TITLE_X_START + TITLE_S_START + 2, TITLE_Y_START + 2],
    [TITLE_X_START + TITLE_S_START + 2, TITLE_Y_START + 4]
  ]

  COUNTDOWN_X_START = 17.5
  COUNTDOWN_Y_START = 12

  COUNTDOWN = [
    # 1
    [
      [COUNTDOWN_X_START + 1, COUNTDOWN_Y_START + 0],
      [COUNTDOWN_X_START + 1, COUNTDOWN_Y_START + 1],
      [COUNTDOWN_X_START + 1, COUNTDOWN_Y_START + 2],
      [COUNTDOWN_X_START + 1, COUNTDOWN_Y_START + 3],
      [COUNTDOWN_X_START + 1, COUNTDOWN_Y_START + 4],
    ],
    # 2
    [
      [COUNTDOWN_X_START + 0, COUNTDOWN_Y_START + 4],
      [COUNTDOWN_X_START + 1, COUNTDOWN_Y_START + 4],
      [COUNTDOWN_X_START + 2, COUNTDOWN_Y_START + 4],
      [COUNTDOWN_X_START + 2, COUNTDOWN_Y_START + 3],
      [COUNTDOWN_X_START + 0, COUNTDOWN_Y_START + 2],
      [COUNTDOWN_X_START + 1, COUNTDOWN_Y_START + 2],
      [COUNTDOWN_X_START + 2, COUNTDOWN_Y_START + 2],
      [COUNTDOWN_X_START + 0, COUNTDOWN_Y_START + 1],
      [COUNTDOWN_X_START + 0, COUNTDOWN_Y_START + 0],
      [COUNTDOWN_X_START + 1, COUNTDOWN_Y_START + 0],
      [COUNTDOWN_X_START + 2, COUNTDOWN_Y_START + 0],
    ],
    # 3
    [
      [COUNTDOWN_X_START + 0, COUNTDOWN_Y_START + 4],
      [COUNTDOWN_X_START + 1, COUNTDOWN_Y_START + 4],
      [COUNTDOWN_X_START + 2, COUNTDOWN_Y_START + 4],
      [COUNTDOWN_X_START + 2, COUNTDOWN_Y_START + 3],
      [COUNTDOWN_X_START + 0, COUNTDOWN_Y_START + 2],
      [COUNTDOWN_X_START + 1, COUNTDOWN_Y_START + 2],
      [COUNTDOWN_X_START + 2, COUNTDOWN_Y_START + 2],
      [COUNTDOWN_X_START + 2, COUNTDOWN_Y_START + 1],
      [COUNTDOWN_X_START + 0, COUNTDOWN_Y_START + 0],
      [COUNTDOWN_X_START + 1, COUNTDOWN_Y_START + 0],
      [COUNTDOWN_X_START + 2, COUNTDOWN_Y_START + 0],
    ],
  ]

  def self.render_title(game)
    Block.render(game, TITLE)

    render_credits(game)
    render_level_menu(game)
  end

  def self.render_countdown(game)
    Block.render(game, COUNTDOWN[game.state.countdown])
  end

  def self.render_gameover(game)
    Block.render(game, TITLE)

    game.outputs.labels << {
      x: (game.grid.w / 2),
      y: (game.grid.h / 2) + 10,
      text: "Game Over",
      size_enum: 8,
      alignment_enum: 1
    }.merge(COLOR_TEXT_DARK)

    render_credits(game)
    render_level_menu(game)

    game.outputs.labels << {
      x: (game.grid.w / 2),
      y: (game.grid.h / 2) - 50,
      text: "Final Score: #{game.state.score}",
      size_enum: 4,
      alignment_enum: 1
    }.merge(COLOR_TEXT_DARK)
  end

  def self.render_level_menu(game)
    game.state.level ||= 1

    if game.inputs.keyboard.key_down.right || game.inputs.keyboard.key_down.d
      game.state.level += 1
      game.state.level = 1 if game.state.level > 3
    end

    if game.inputs.keyboard.key_down.left || game.inputs.keyboard.key_down.a
      game.state.level -= 1
      game.state.level = 3 if game.state.level < 1
    end

    game.outputs.labels << {
      x: (game.grid.w / 2),
      y: (game.grid.h / 2) - 100,
      text: "Select Level",
      size_enum: 4,
      alignment_enum: 1
    }.merge(COLOR_TEXT_DARK)

    3.times do |i|
      text = game.state.level == (i + 1) ? "< Level #{i + 1} >" : "Level #{i + 1}"
      game.outputs.labels << {
        x: (game.grid.w / 4) * (i + 1),
        y: (game.grid.h / 2) - 150,
        text: text,
        size_enum: 4,
        alignment_enum: 1
      }.merge(COLOR_TEXT_DARK)
    end

    game.outputs.labels << {
      x: (game.grid.w / 2),
      y: (game.grid.h / 2) - 200,
      text: "Use Arrows/WASD to move. Press SPACEBAR to start",
      size_enum: 4,
      alignment_enum: 1
    }.merge(COLOR_TEXT_DARK)
  end

  def self.render_credits(game)
    game.outputs.labels << {
      x: GRID_START_X,
      y: game.grid.h - 10,
      text: "Created by t27duck",
      size_enum: 5,
      anchor_x: 0
    }.merge(COLOR_TEXT_DARK)
  end
end
